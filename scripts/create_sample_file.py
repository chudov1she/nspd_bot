"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏–º–µ—Ä–∞ Excel —Ñ–∞–π–ª–∞ —Å –∫–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏.
"""
from pathlib import Path
from openpyxl import Workbook
from openpyxl.styles import Font, Alignment
import sys

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –ø—É—Ç—å
sys.path.insert(0, str(Path(__file__).resolve().parent.parent))

from bot.config.settings import settings


def create_sample_excel_file() -> Path:
    """–°–æ–∑–¥–∞–µ—Ç –ø—Ä–∏–º–µ—Ä Excel —Ñ–∞–π–ª–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –∑–µ–º–µ–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–∫–∞—Ö."""
    
    # –°–æ–∑–¥–∞–µ–º —Ä–∞–±–æ—á—É—é –∫–Ω–∏–≥—É
    wb = Workbook()
    ws = wb.active
    ws.title = "–ó–µ–º–µ–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏"
    
    # –ó–∞–≥–æ–ª–æ–≤–∫–∏
    headers = [
        "‚Ññ",
        "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ",
        "–ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä",
        "–ê–¥—Ä–µ—Å (–º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ)",
        "–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å, –∫–≤. –º",
        "–ö–∞—Ç–µ–≥–æ—Ä–∏—è",
        "–†–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ",
        "–ö–∞–¥–∞—Å—Ç—Ä–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å",
        "–ü–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –ø—Ä–∞–≤–∞",
        "–ü—Ä–∞–≤–æ–æ–±–ª–∞–¥–∞—Ç–µ–ª—å (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫)",
        "–û–±—Ä–µ–º–µ–Ω–µ–Ω–∏—è (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)"
    ]
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
    for col_idx, header in enumerate(headers, start=1):
        cell = ws.cell(row=1, column=col_idx, value=header)
        cell.font = Font(bold=True)
        cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
    
    # –î–∞–Ω–Ω—ã–µ
    data = [
        [
            1,
            "–ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫",
            "78:38:0022629:1131",
            "–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ø. –£—à–∫–æ–≤–æ, —à. –ü—Ä–∏–º–æ—Ä—Å–∫–æ–µ, –¥. 613, –ª–∏—Ç–µ—Ä–∞ –í, –ó–£2",
            2.874,
            "–ó–µ–º–ª–∏ –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤",
            "–î–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –¥–∞—á",
            23862231.11,
            "–ü—Ä–∞–≤–æ –æ–±—â–µ–π –¥–æ–ª–µ–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏",
            "",
            "–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
        ],
        [
            2,
            "–ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫",
            "78:38:0022629:1115",
            "–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ø. –£—à–∫–æ–≤–æ, —à. –ü—Ä–∏–º–æ—Ä—Å–∫–æ–µ, –¥. 613, –ª–∏—Ç–µ—Ä–∞ –í, –ó–£3",
            2.956,
            "–ó–µ–º–ª–∏ –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤",
            "–î–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –¥–∞—á",
            24224607.11,
            "–ü—Ä–∞–≤–æ –æ–±—â–µ–π –¥–æ–ª–µ–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏",
            "",
            "–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
        ],
        [
            3,
            "–ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫",
            "78:38:0022629:1118",
            "–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ø. –£—à–∫–æ–≤–æ, —à. –ü—Ä–∏–º–æ—Ä—Å–∫–æ–µ, –¥. 613, –ª–∏—Ç–µ—Ä–∞ –í, –ó–£4",
            2.800,
            "–ó–µ–º–ª–∏ –Ω–∞—Å–µ–ª—ë–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤",
            "–î–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –¥–∞—á",
            22652330.96,
            "–ü—Ä–∞–≤–æ –æ–±—â–µ–π –¥–æ–ª–µ–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏",
            "",
            "–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
        ]
    ]
    
    # –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
    for row_idx, row_data in enumerate(data, start=2):
        for col_idx, value in enumerate(row_data, start=1):
            cell = ws.cell(row=row_idx, column=col_idx, value=value)
            cell.alignment = Alignment(vertical='top', wrap_text=True)
    
    # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–æ–∫
    column_widths = {
        'A': 5,   # ‚Ññ
        'B': 20,  # –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
        'C': 25,  # –ö–∞–¥–∞—Å—Ç—Ä–æ–≤—ã–π –Ω–æ–º–µ—Ä
        'D': 60,  # –ê–¥—Ä–µ—Å
        'E': 18,  # –ü–ª–æ—â–∞–¥—å
        'F': 25,  # –ö–∞—Ç–µ–≥–æ—Ä–∏—è
        'G': 25,  # –†–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
        'H': 22,  # –ö–∞–¥–∞—Å—Ç—Ä–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
        'I': 30,  # –ü–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –ø—Ä–∞–≤–∞
        'J': 30,  # –ü—Ä–∞–≤–æ–æ–±–ª–∞–¥–∞—Ç–µ–ª—å
        'K': 30   # –û–±—Ä–µ–º–µ–Ω–µ–Ω–∏—è
    }
    
    for col, width in column_widths.items():
        ws.column_dimensions[col].width = width
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª
    output_dir = settings.DATA_DIR / "input"
    output_dir.mkdir(parents=True, exist_ok=True)
    
    file_path = output_dir / "example_cadastral_numbers.xlsx"
    wb.save(file_path)
    
    print(f"‚úÖ –§–∞–π–ª —Å–æ–∑–¥–∞–Ω: {file_path}")
    print(f"üìä –°–æ–∑–¥–∞–Ω–æ –∑–∞–ø–∏—Å–µ–π: {len(data)}")
    
    return file_path


if __name__ == "__main__":
    create_sample_excel_file()

